<xh:html xmlns:xh="http://www.w3.org/1999/xhtml"
         xmlns:xxf="http://orbeon.org/oxf/xml/xforms"
         xmlns:xxi="http://orbeon.org/oxf/xml/xinclude"
         xmlns:saxon="http://saxon.sf.net/"
         xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
         xmlns:xf="http://www.w3.org/2002/xforms"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:sql="http://orbeon.org/oxf/xml/sql"
         xmlns:ev="http://www.w3.org/2001/xml-events"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:exf="http://www.exforms.org/exf/1-0"
         xmlns:array="http://www.w3.org/2005/xpath-functions/array"
         xmlns:xs="http://www.w3.org/2001/XMLSchema"
         xmlns:math="http://www.w3.org/2005/xpath-functions/math"
         xmlns:fb="http://orbeon.org/oxf/xml/form-builder"
         xmlns:map="http://www.w3.org/2005/xpath-functions/map"
         xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
    <xh:head>
        <xh:title>Podsumowanie finansowe</xh:title>
        <xh:style type="text/css">
            .hide-section{display: none !important}
        </xh:style>
        <xf:model id="fr-form-model" xxf:expose-xpath-types="true" xxf:analysis.calculate="true">

            <!-- Main instance -->
            <xf:instance id="fr-form-instance" xxf:exclude-result-prefixes="#all" xxf:index="id">
                <form>
                    <personal-data-section>
                        <personal-data-grid>
                            <name/>
                            <surname/>
                            <birth-date/>

                            <student-id/>
                            <show-overall-finances/>
                        </personal-data-grid>
                    </personal-data-section>
                    <overall-finances-section>

                        <overall-financial-repeat>
                            <overall-financial-repeat-iteration>
                                <overall-operation-id/>
                                <term-number/>
                                <overall-operation-type/>
                                <overall-value/>
                                <overall-description/>




                            </overall-financial-repeat-iteration>
                        </overall-financial-repeat>
                        <overall-results-grid>
                            <overall-summed-up/>
                        </overall-results-grid>

                    </overall-finances-section>

                    <term-results-section>
                        <term-results-grid>
                            <term/>



                        </term-results-grid>
                        <term-finances-repeat>
                            <term-finances-repeat-iteration>
                                <term-operation-id/>
                                <term-operation-type/>
                                <term-value/>

                                <term-description/>




                            </term-finances-repeat-iteration>
                        </term-finances-repeat>
                        <grid-1>
                            <term-summed-up/>
                        </grid-1>

                    </term-results-section>
                </form>
            </xf:instance>

            <!-- Bindings -->
            <xf:bind id="fr-form-binds" ref="instance('fr-form-instance')">
                <xf:bind id="personal-data-section-bind" name="personal-data-section"
                         ref="personal-data-section">
                    <xf:bind id="personal-data-grid-bind" ref="personal-data-grid" name="personal-data-grid">
                        <xf:bind id="name-bind" name="name" ref="name" xxf:whitespace="trim"
                                 calculate="fr:dataset('studentDataset')//name"/>
                        <xf:bind id="surname-bind" ref="surname" name="surname" xxf:whitespace="trim"
                                 calculate="fr:dataset('studentDataset')//surname"/>
                        <xf:bind id="student-id-bind" ref="student-id" name="student-id" xxf:whitespace="trim"/>
                        <xf:bind id="birth-date-bind" ref="birth-date" name="birth-date"
                                 calculate="format-date(xs:date(substring-before((fr:dataset('studentDataset')//birthDate), 'T')), '[D01]-[M01]-[Y0001]')"/>
                        <xf:bind id="show-overall-finances-bind" ref="show-overall-finances"
                                 name="show-overall-finances"/>

                    </xf:bind>
                </xf:bind>

                <xf:bind id="term-results-section-bind" ref="term-results-section"
                         name="term-results-section">
                    <xf:bind id="term-results-grid-bind" ref="term-results-grid" name="term-results-grid">
                        <xf:bind id="term-bind" ref="term" name="term"/>



                    </xf:bind>
                    <xf:bind id="term-finances-repeat-bind" ref="term-finances-repeat"
                             name="term-finances-repeat">
                        <xf:bind id="term-finances-repeat-iteration-bind" ref="term-finances-repeat-iteration"
                                 name="term-finances-repeat-iteration">





                            <xf:bind id="term-description-bind" ref="term-description" name="term-description"
                                     xxf:whitespace="trim"/>

                            <xf:bind id="term-operation-type-bind" ref="term-operation-type"
                                     name="term-operation-type"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="term-operation-id-bind" ref="term-operation-id" name="term-operation-id"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="term-value-bind" ref="term-value" name="term-value" xxf:whitespace="trim"/>


                        </xf:bind>
                    </xf:bind>
                    <xf:bind id="grid-1-bind" ref="grid-1" name="grid-1">
                        <xf:bind id="term-summed-up-bind" ref="term-summed-up" name="term-summed-up"
                                 xxf:whitespace="trim"
                                 calculate="format-number(sum($term-value) , '0.00')"
                                 readonly="false()"/>
                    </xf:bind>
                </xf:bind>
                <xf:bind id="overall-finances-section-bind" ref="overall-finances-section"
                         name="overall-finances-section"
                         relevant="$show-overall-finances = 'yes'">

                    <xf:bind id="overall-financial-repeat-bind" ref="overall-financial-repeat"
                             name="overall-financial-repeat">
                        <xf:bind id="overall-financial-repeat-iteration-bind"
                                 ref="overall-financial-repeat-iteration"
                                 name="overall-financial-repeat-iteration">
                            <xf:bind id="overall-operation-id-bind" ref="overall-operation-id"
                                     name="overall-operation-id"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="term-number-bind" ref="term-number" name="term-number"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="overall-operation-type-bind" ref="overall-operation-type"
                                     name="overall-operation-type"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="overall-value-bind" ref="overall-value" name="overall-value"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="overall-description-bind" ref="overall-description"
                                     name="overall-description"
                                     xxf:whitespace="trim"/>




                        </xf:bind>
                    </xf:bind>
                    <xf:bind id="overall-results-grid-bind" ref="overall-results-grid"
                             name="overall-results-grid">
                        <xf:bind id="overall-summed-up-bind" ref="overall-summed-up" name="overall-summed-up"
                                 xxf:whitespace="trim"
                                 calculate="format-number(sum($overall-value), '0.00')"
                                 readonly="false()"/>
                    </xf:bind>

                </xf:bind>
            </xf:bind>

            <!-- Metadata -->
            <xf:instance id="fr-form-metadata" xxf:readonly="true" xxf:exclude-result-prefixes="#all">
                <metadata>
                    <application-name>summary</application-name>
                    <form-name>student_financal_summary</form-name>
                    <title xml:lang="pl">Podsumowanie finansowe</title>
                    <description xml:lang="pl">Podsumowanie finansowe studenta</description>
                    <created-with-version>2022.1.4.1.202305310006 PE</created-with-version>
                    <updated-with-version>2022.1.4.1.202305310006 PE</updated-with-version>
                    <email>
                        <templates>
                            <template name="default">
                                <form-fields/>
                            </template>
                        </templates>
                        <parameters/>
                    </email>
                    <library-versions>
                        <orbeon>1</orbeon>
                    </library-versions>

                    <rendered-page-orientation>landscape</rendered-page-orientation>
                    <xbl>
                        <fr:number decimal-separator="," grouping-separator=" " digits-after-decimal="2"/>
                        <fr:time output-format="[H]:[m]:[s]"/>
                    </xbl>
                </metadata>
            </xf:instance>

            <!-- Attachments -->
            <xf:instance id="fr-form-attachments" xxf:exclude-result-prefixes="#all">
                <attachments/>
            </xf:instance>

            <!-- All form resources -->
            <xf:instance xxf:readonly="true" id="fr-form-resources" xxf:exclude-result-prefixes="#all">
                <resources>
                    <resource xml:lang="pl">
                        <term-summed-up>
                            <label>Sumarycznie</label>
                            <hint/>
                        </term-summed-up>
                        <overall-summed-up>
                            <label>Sumarycznie</label>
                            <hint/>
                        </overall-summed-up>
                        <term-operation-id>
                            <label>Id operacji</label>
                            <hint/>
                        </term-operation-id>
                        <term-operation-type>
                            <label>Typ operacji</label>
                            <hint/>
                        </term-operation-type>
                        <term-value>
                            <label>Wartość</label>
                            <hint/>
                        </term-value>

                        <term-description>
                            <label>Opis</label>
                            <hint/>
                        </term-description>




                        <term>
                            <label>Semestr</label>
                            <hint/>



                        </term>












                        <personal-data-section>
                            <label>Dane osobowe</label>
                        </personal-data-section>
                        <overall-finances-section>
                            <label>Podsumowanie przebiegu operacji finansowych</label>
                        </overall-finances-section>
                        <overall-operation-id>
                            <label>Id operacji</label>
                            <hint/>
                        </overall-operation-id>
                        <term-number>
                            <label>Numer semestru</label>
                            <hint/>
                        </term-number>
                        <overall-operation-type>
                            <label>Typ operacji</label>
                            <hint/>
                        </overall-operation-type>
                        <overall-value>
                            <label>Wartość</label>
                            <hint/>
                        </overall-value>
                        <overall-description>
                            <label>Opis</label>
                            <hint/>
                        </overall-description>

                        <term-results-section>
                            <label>Podsumowanie semestru</label>
                        </term-results-section>
                        <name>
                            <label>Imię</label>
                            <hint/>
                        </name>
                        <surname>
                            <label>Nazwisko</label>
                            <hint/>
                        </surname>
                        <birth-date>
                            <label>Data urodzenia</label>
                            <hint/>
                        </birth-date>

                        <student-id>
                            <label>Id studenta</label>
                            <hint/>
                        </student-id>
                        <show-overall-finances>
                            <label>Czy pokazać zestawienie całościowe?</label>
                            <hint/>
                            <item>
                                <label>TAK</label>
                                <hint/>
                                <value>yes</value>
                            </item>
                            <item>
                                <label>NIE</label>
                                <hint/>
                                <value>no</value>
                            </item>
                        </show-overall-finances>
                    </resource>
                </resources>
            </xf:instance>

            <xf:instance id="empty-term">
                <root>
                    <_>
                        <empty-item-label>Nie wybieram żadnego semestru</empty-item-label>
                        <empty-item-value>none</empty-item-value>
                    </_>
                </root>

            </xf:instance>
            <xf:instance xxf:readonly="true" xxf:exclude-result-prefixes="#all"
                         id="term-finances-repeat-template">
                <term-finances-repeat-iteration>
                    <term-description/>
                    <term-operation-type/>
                    <term-operation-id/>
                    <term-value/>
                </term-finances-repeat-iteration>
            </xf:instance>
            <xf:instance xxf:readonly="true" xxf:exclude-result-prefixes="#all"
                         id="overall-financial-repeat-template">
                <overall-financial-repeat-iteration>
                    <overall-operation-id/>
                    <term-number/>
                    <overall-operation-type/>
                    <overall-value/>
                    <overall-description/>
                </overall-financial-repeat-iteration>
            </xf:instance>
            <xf:instance id="getStudentData-instance" class="fr-service"
                         xxf:exclude-result-prefixes="#all">
                <body xmlns:xxbl="http://orbeon.org/oxf/xml/xbl"
                      xmlns:fbf="java:org.orbeon.oxf.fb.FormBuilderXPathApi">&lt;params&gt;
                &lt;param name="id"/&gt;
                &lt;/params&gt;</body>
            </xf:instance>
            <xf:submission id="getStudentData-submission" class="fr-service"
                           resource="http://localhost:8080/api/users/user"
                           method="get"
                           serialization="application/x-www-form-urlencoded"
                           mediatype="application/x-www-form-urlencoded"/>
            <xf:action event="xforms-ready">
                <xf:delete ref="instance('fr-form-instance')//overall-financial-repeat-iteration"/>
                <xf:delete ref="instance('fr-form-instance')//term-finances-repeat-iteration"/>
            </xf:action>
            <xf:action id="getStudentData-binding">
                <xf:action event="xforms-value-changed" ev:observer="student-id-control" if="true()">
                    <xf:send submission="getStudentData-submission"/>
                </xf:action>
                <xf:action event="xforms-submit" ev:observer="getStudentData-submission">
                    <xf:var name="request-instance-name" value="'getStudentData-instance'"/>
                    <xf:action>
                        <xf:action class="fr-set-service-value-action">
                            <xf:var name="control-name" value="'student-id'"/>
                            <xf:var name="parameter-name" value="'id'"/>
                        </xf:action>
                    </xf:action>
                </xf:action>
                <xf:action event="xforms-submit-done" ev:observer="getStudentData-submission">
                    <xf:action class="fr-save-to-dataset-action">
                        <xf:var name="dataset-name">studentDataset</xf:var>
                    </xf:action>
                    <xf:action class="fr-itemset-action">
                        <xf:var name="control-name" value="'term'"/>
                        <xf:var name="response-items" value="(//terms/_ | instance('empty-term')//_)"/>
                        <xf:var name="item-label" value="termNumber | empty-item-label"/>
                        <xf:var name="item-value" value="termNumber | empty-item-value"/>
                    </xf:action>
                </xf:action>
            </xf:action>
            <xf:dispatch name="load-student-data" delay="10" targetid="fr-form-model"
                         event="xforms-submit-done"
                         ev:observer="getStudentData-submission"/>
            <xf:action event="load-student-data" if="true()">
                <xf:var name="insert-template"
                        select="xxf:extract-document(instance('overall-financial-repeat-template'))">
                </xf:var>
                <xf:delete ref="instance('fr-form-instance')//overall-financial-repeat-iteration"/>
                <xf:action iterate="fr:dataset('studentDataset')//overallResults//termFinances//operationFinances//_">
                    <xf:var name="current" select="."/>
                    <xf:setvalue ref="$insert-template//overall-operation-id" value="$current//id"/>
                    <xf:setvalue ref="$insert-template//term-number" value="$current/../../../..//termNumber"/>
                    <xf:setvalue ref="$insert-template//overall-operation-type" value="$current//operationName"/>
                    <xf:setvalue ref="$insert-template//overall-value" value="$current//value"/>
                    <xf:setvalue ref="$insert-template//overall-description" value="$current//description"/>


                    <xf:insert if="count(instance('fr-form-instance')//overall-finances-section/overall-financial-repeat/overall-financial-repeat-iteration) &gt; 0"
                               ref="instance('fr-form-instance')//overall-finances-section/overall-financial-repeat/overall-financial-repeat-iteration"
                               at="last()"
                               position="after"
                               origin="$insert-template">
                    </xf:insert>
                    <xf:insert if="count(instance('fr-form-instance')//overall-finances-section/overall-financial-repeat/overall-financial-repeat-iteration) = 0"
                               context="instance('fr-form-instance')//overall-finances-section/overall-financial-repeat"
                               at="last()"
                               origin="$insert-template">

                    </xf:insert>
                </xf:action>
            </xf:action>
            <xf:dispatch name="term-changed-data" delay="10" targetid="fr-form-model"
                         event="xforms-value-changed"
                         ev:observer="term-control"/>
            <xf:action event="term-changed-data" if="true()">
                <xf:var name="insert-template"
                        select="xxf:extract-document(instance('term-finances-repeat-template'))">
                </xf:var>
                <xf:var name="selected-term" value="instance('fr-form-instance')//term"/>
                <xf:delete ref="instance('fr-form-instance')//term-finances-repeat-iteration"/>
                <xf:action iterate="fr:dataset('studentDataset')//overallResults/terms/_[./termNumber = $selected-term]/termFinances/operationFinances/_">
                    <xf:var name="current" select="."/>
                    <xf:setvalue ref="$insert-template//term-operation-id" value="$current//id"/>
                    <xf:setvalue ref="$insert-template//term-operation-type" value="$current//operationName"/>
                    <xf:setvalue ref="$insert-template//term-value" value="$current//value"/>
                    <xf:setvalue ref="$insert-template//term-description" value="$current//description"/>


                    <xf:insert if="count(instance('fr-form-instance')//term-finances-repeat/term-finances-repeat-iteration) &gt; 0"
                               ref="instance('fr-form-instance')//term-finances-repeat/term-finances-repeat-iteration"
                               at="last()"
                               position="after"
                               origin="$insert-template">
                    </xf:insert>
                    <xf:insert if="count(instance('fr-form-instance')//term-finances-repeat/term-finances-repeat-iteration) = 0"
                               context="instance('fr-form-instance')//term-finances-repeat"
                               at="last()"
                               origin="$insert-template">

                    </xf:insert>
                </xf:action>
            </xf:action>
        </xf:model>
    </xh:head>
    <xh:body>
        <fr:view>
            <fr:body xmlns:xbl="http://www.w3.org/ns/xbl" xmlns:p="http://www.orbeon.com/oxf/pipeline"
                     xmlns:oxf="http://www.orbeon.com/oxf/processors">
                <fr:section id="personal-data-section-section" bind="personal-data-section-bind">
                    <xf:label ref="$form-resources/personal-data-section/label"/>
                    <fr:grid id="personal-data-grid-grid" bind="personal-data-grid-bind">
                        <fr:c y="1" x="1" w="6">
                            <xf:input id="name-control" bind="name-bind">
                                <xf:label ref="$form-resources/name/label"/>
                                <xf:hint ref="$form-resources/name/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c y="1" x="7" w="6">
                            <xf:input id="surname-control" bind="surname-bind">
                                <xf:label ref="$form-resources/surname/label"/>
                                <xf:hint ref="$form-resources/surname/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="2" w="6">
                            <xf:input id="birth-date-control" bind="birth-date-bind">
                                <xf:label ref="$form-resources/birth-date/label"/>
                                <xf:hint ref="$form-resources/birth-date/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>

                        </fr:c>
                        <fr:c x="7" y="2" w="6">
                            <xf:input id="student-id-control" bind="student-id-bind">
                                <xf:label ref="$form-resources/student-id/label"/>
                                <xf:hint ref="$form-resources/student-id/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="3" w="6">
                            <xf:select1 id="show-overall-finances-control" appearance="full"
                                        bind="show-overall-finances-bind">
                                <xf:label ref="$form-resources/show-overall-finances/label"/>
                                <xf:hint ref="$form-resources/show-overall-finances/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                                <xf:itemset ref="$form-resources/show-overall-finances/item">
                                    <xf:label ref="label"/>
                                    <xf:value ref="value"/>
                                    <xf:hint ref="hint"/>
                                </xf:itemset>
                            </xf:select1>
                        </fr:c>
                        <fr:c x="7" y="3" w="6"/>
                    </fr:grid>
                </fr:section>
                <fr:section id="overall-finances-section-section" bind="overall-finances-section-bind">
                    <xf:label ref="$form-resources/overall-finances-section/label"/>

                    <fr:grid id="overall-financial-repeat-grid" bind="overall-financial-repeat-bind"
                             repeat="content"
                             min="{'1000'}"
                             template="instance('overall-financial-repeat-template')"
                             apply-defaults="true"
                             fb:initial-iterations="first"
                             max="{'0'}"
                             freeze="{'1000'}"
                             class="hide-section">
                        <fr:c x="1" y="1" w="4">
                            <xf:input id="overall-operation-id-control" bind="overall-operation-id-bind">
                                <xf:label ref="$form-resources/overall-operation-id/label"/>
                                <xf:hint ref="$form-resources/overall-operation-id/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="1" w="4" h="1">
                            <xf:input id="term-number-control" bind="term-number-bind">
                                <xf:label ref="$form-resources/term-number/label"/>
                                <xf:hint ref="$form-resources/term-number/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="1" w="4">
                            <xf:input id="overall-operation-type-control" bind="overall-operation-type-bind">
                                <xf:label ref="$form-resources/overall-operation-type/label"/>
                                <xf:hint ref="$form-resources/overall-operation-type/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="2" w="4">
                            <xf:input id="overall-value-control" bind="overall-value-bind">
                                <xf:label ref="$form-resources/overall-value/label"/>
                                <xf:hint ref="$form-resources/overall-value/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="2" w="4" h="1">
                            <xf:input id="overall-description-control" bind="overall-description-bind">
                                <xf:label ref="$form-resources/overall-description/label"/>
                                <xf:hint ref="$form-resources/overall-description/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="2" w="4">

                        </fr:c>



                    </fr:grid>
                    <fr:grid id="overall-results-grid-grid" bind="overall-results-grid-bind">
                        <fr:c x="1" y="1" w="4">
                            <xf:input id="overall-summed-up-control" bind="overall-summed-up-bind"
                                      class="hide-section">
                                <xf:label ref="$form-resources/overall-summed-up/label"/>
                                <xf:hint ref="$form-resources/overall-summed-up/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="1" w="4" h="1"/>
                        <fr:c x="9" y="1" w="4"/>
                    </fr:grid>

                    <br/>
                    <xh:table border="1" width="100%">
                        <xh:tr class="table-header">
                            <xh:th>Id operacji</xh:th>
                            <xh:th>Numer semestru</xh:th>
                            <xh:th>Typ operacji</xh:th>
                            <xh:th>Opis</xh:th>
                            <xh:th>Wartość</xh:th>
                        </xh:tr>
                        <xf:repeat ref=".//overall-financial-repeat-iteration">
                            <xh:tr>
                                <xh:td class="td-text-value">
                                    <xf:output value="./overall-operation-id"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./term-number"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./overall-operation-type"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./overall-description"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./overall-value"/>
                                </xh:td>
                            </xh:tr>
                        </xf:repeat>
                        <xh:tr class="table-footer">
                            <xh:td class="td-text-value" colspan="4">
                                <b>Razem:</b>
                            </xh:td>
                            <xh:td class="td-number-value">
                                <xf:output value=".//overall-summed-up"/>
                            </xh:td>
                        </xh:tr>
                    </xh:table>
                </fr:section>

                <fr:section id="term-results-section-section" bind="term-results-section-bind">
                    <xf:label ref="$form-resources/term-results-section/label"/>
                    <fr:grid id="term-results-grid-grid" bind="term-results-grid-bind">
                        <fr:c x="1" y="1" w="6">
                            <xf:select1 id="term-control" bind="term-bind" appearance="dropdown">
                                <xf:label ref="$form-resources/term/label"/>
                                <xf:hint ref="$form-resources/term/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                                <xf:itemset ref="$form-resources/term/item">
                                    <xf:label ref="label"/>
                                    <xf:value ref="value"/>
                                    <xf:hint ref="hint"/>
                                </xf:itemset>
                            </xf:select1>

                        </fr:c>
                        <fr:c x="7" y="1" w="6">

                        </fr:c>


                    </fr:grid>
                    <fr:grid id="term-finances-repeat-grid" bind="term-finances-repeat-bind"
                             repeat="content"
                             min="1"
                             template="instance('term-finances-repeat-template')"
                             apply-defaults="true"
                             fb:initial-iterations="first"
                             class="hide-section">
                        <fr:c x="1" y="1" w="4">
                            <xf:input id="term-operation-id-control" bind="term-operation-id-bind">
                                <xf:label ref="$form-resources/term-operation-id/label"/>
                                <xf:hint ref="$form-resources/term-operation-id/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>



                            </xf:input>

                        </fr:c>
                        <fr:c x="5" y="1" w="4" h="1">
                            <xf:input id="term-operation-type-control" bind="term-operation-type-bind">
                                <xf:label ref="$form-resources/term-operation-type/label"/>
                                <xf:hint ref="$form-resources/term-operation-type/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>




                            </xf:input>

                        </fr:c>
                        <fr:c x="9" y="1" w="4">
                            <xf:input id="term-value-control" bind="term-value-bind">
                                <xf:label ref="$form-resources/term-value/label"/>
                                <xf:hint ref="$form-resources/term-value/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>


                        </fr:c>
                        <fr:c x="1" y="2" w="4">
                            <xf:input id="term-description-control" bind="term-description-bind">
                                <xf:label ref="$form-resources/term-description/label"/>
                                <xf:hint ref="$form-resources/term-description/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>



                            </xf:input>

                        </fr:c>
                        <fr:c x="5" y="2" w="4">


                        </fr:c>
                        <fr:c x="9" y="2" w="4">


                        </fr:c>
                    </fr:grid>
                    <fr:grid id="grid-1-grid" bind="grid-1-bind">
                        <fr:c x="1" y="1" w="6">
                            <xf:input id="term-summed-up-control" bind="term-summed-up-bind" class="hide-section">
                                <xf:label ref="$form-resources/term-summed-up/label"/>
                                <xf:hint ref="$form-resources/term-summed-up/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="7" y="1" w="6"/>
                    </fr:grid>

                    <br/>
                    <xh:table border="1" width="100%">
                        <xh:tr class="table-header">
                            <xh:th>Id operacji</xh:th>
                            <xh:th>Typ operacji</xh:th>
                            <xh:th>Opis</xh:th>
                            <xh:th>Wartość</xh:th>
                        </xh:tr>
                        <xf:repeat ref=".//term-finances-repeat-iteration">
                            <xh:tr>
                                <xh:td class="td-text-value">
                                    <xf:output value="./term-operation-id"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./term-operation-type"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./term-description"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./term-value"/>
                                </xh:td>
                            </xh:tr>
                        </xf:repeat>
                        <xh:tr class="table-footer">
                            <xh:td class="td-text-value" colspan="3">
                                <b>Razem:</b>
                            </xh:td>
                            <xh:td class="td-number-value">
                                <xf:output value=".//term-summed-up"/>
                            </xh:td>
                        </xh:tr>
                    </xh:table>
                </fr:section>
            </fr:body>
        </fr:view>
    </xh:body>
</xh:html>