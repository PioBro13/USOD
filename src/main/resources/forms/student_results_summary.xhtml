<xh:html xmlns:xh="http://www.w3.org/1999/xhtml"
         xmlns:xxf="http://orbeon.org/oxf/xml/xforms"
         xmlns:xxi="http://orbeon.org/oxf/xml/xinclude"
         xmlns:saxon="http://saxon.sf.net/"
         xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
         xmlns:xf="http://www.w3.org/2002/xforms"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:sql="http://orbeon.org/oxf/xml/sql"
         xmlns:ev="http://www.w3.org/2001/xml-events"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:exf="http://www.exforms.org/exf/1-0"
         xmlns:array="http://www.w3.org/2005/xpath-functions/array"
         xmlns:xs="http://www.w3.org/2001/XMLSchema"
         xmlns:math="http://www.w3.org/2005/xpath-functions/math"
         xmlns:fb="http://orbeon.org/oxf/xml/form-builder"
         xmlns:map="http://www.w3.org/2005/xpath-functions/map"
         xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
    <xh:head>
        <xh:title>Podsumowanie wyników</xh:title>
        <xh:style type="text/css">
            .hide-section{display: none !important}
        </xh:style>
        <xf:model id="fr-form-model" xxf:expose-xpath-types="true" xxf:analysis.calculate="true">

            <!-- Main instance -->
            <xf:instance id="fr-form-instance" xxf:exclude-result-prefixes="#all" xxf:index="id">
                <form>
                    <personal-data-section>
                        <personal-data-grid>
                            <name/>
                            <surname/>
                            <birth-date/>

                            <student-id/>
                        </personal-data-grid>
                    </personal-data-section>
                    <overall-results-section>

                        <overall-results-repeat>
                            <overall-results-repeat-iteration>
                                <term-number/>
                                <register-type/>
                                <student-group/>
                                <starting-ects/>
                                <final-ects/>
                                <nominal-ects/>
                                <obtained-ects/>
                                <speciality/>
                                <ects-difference/>
                            </overall-results-repeat-iteration>
                        </overall-results-repeat>
                        <overall-results-grid/>

                    </overall-results-section>
                    <term-results-section>
                        <term-results-grid>
                            <term/>



                        </term-results-grid>
                        <term-subjects-repeat>
                            <term-subjects-repeat-iteration>
                                <subject-name/>
                                <exam/>
                                <student-term-number/>
                                <ects-number/>
                                <instructor/>
                                <grade/>
                            </term-subjects-repeat-iteration>
                        </term-subjects-repeat>
                    </term-results-section>
                </form>
            </xf:instance>

            <!-- Bindings -->
            <xf:bind id="fr-form-binds" ref="instance('fr-form-instance')">
                <xf:bind id="personal-data-section-bind" name="personal-data-section"
                         ref="personal-data-section">
                    <xf:bind id="personal-data-grid-bind" ref="personal-data-grid" name="personal-data-grid">
                        <xf:bind id="name-bind" name="name" ref="name" xxf:whitespace="trim"
                                 calculate="fr:dataset('studentDataset')//name"/>
                        <xf:bind id="surname-bind" ref="surname" name="surname" xxf:whitespace="trim"
                                 calculate="fr:dataset('studentDataset')//surname"/>
                        <xf:bind id="student-id-bind" ref="student-id" name="student-id" xxf:whitespace="trim"/>
                        <xf:bind id="birth-date-bind" ref="birth-date" name="birth-date" type="xf:date"
                                 calculate="fr:dataset('studentDataset')//birthDate"/>

                    </xf:bind>
                </xf:bind>
                <xf:bind id="overall-results-section-bind" ref="overall-results-section"
                         name="overall-results-section">

                    <xf:bind id="overall-results-repeat-bind" ref="overall-results-repeat"
                             name="overall-results-repeat">
                        <xf:bind id="overall-results-repeat-iteration-bind"
                                 ref="overall-results-repeat-iteration"
                                 name="overall-results-repeat-iteration">
                            <xf:bind id="term-number-bind" ref="term-number" name="term-number"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="register-type-bind" ref="register-type" name="register-type"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="student-group-bind" ref="student-group" name="student-group"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="starting-ects-bind" ref="starting-ects" name="starting-ects"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="final-ects-bind" ref="final-ects" name="final-ects" xxf:whitespace="trim"/>
                            <xf:bind id="nominal-ects-bind" ref="nominal-ects" name="nominal-ects"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="obtained-ects-bind" ref="obtained-ects" name="obtained-ects"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="speciality-bind" ref="speciality" name="speciality" xxf:whitespace="trim"/>
                            <xf:bind id="ects-difference-bind" ref="ects-difference" name="ects-difference"
                                     xxf:whitespace="trim"
                                     calculate="$obtained-ects - $nominal-ects"
                                     readonly="false()"/>
                        </xf:bind>
                    </xf:bind>
                    <xf:bind id="overall-results-grid-bind" ref="overall-results-grid"
                             name="overall-results-grid"/>

                </xf:bind>
                <xf:bind id="term-results-section-bind" ref="term-results-section"
                         name="term-results-section">
                    <xf:bind id="term-results-grid-bind" ref="term-results-grid" name="term-results-grid">
                        <xf:bind id="term-bind" ref="term" name="term"/>



                    </xf:bind>
                    <xf:bind id="term-subjects-repeat-bind" ref="term-subjects-repeat"
                             name="term-subjects-repeat">
                        <xf:bind id="term-subjects-repeat-iteration-bind" ref="term-subjects-repeat-iteration"
                                 name="term-subjects-repeat-iteration">
                            <xf:bind id="subject-name-bind" ref="subject-name" name="subject-name"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="exam-bind" ref="exam" name="exam" xxf:whitespace="trim"
                                     calculate="if (. != 'true') then 'NIE' else 'TAK'"
                                     readonly="false()"/>
                            <xf:bind id="student-term-number-bind" ref="student-term-number"
                                     name="student-term-number"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="ects-number-bind" ref="ects-number" name="ects-number"
                                     xxf:whitespace="trim"/>
                            <xf:bind id="instructor-bind" ref="instructor" name="instructor" xxf:whitespace="trim"/>
                            <xf:bind id="grade-bind" ref="grade" name="grade" xxf:whitespace="trim"
                                     calculate="if(. &gt; 1) then . else '-'"
                                     readonly="false()"/>
                        </xf:bind>
                    </xf:bind>
                </xf:bind>
            </xf:bind>

            <!-- Metadata -->
            <xf:instance id="fr-form-metadata" xxf:readonly="true" xxf:exclude-result-prefixes="#all">
                <metadata>
                    <application-name>summary</application-name>
                    <form-name>student_results_summary</form-name>
                    <title xml:lang="pl">Podsumowanie wyników</title>
                    <description xml:lang="pl">Podsumowanie wyników studenta</description>
                    <created-with-version>2022.1.4.1.202305310006 PE</created-with-version>
                    <updated-with-version>2022.1.4.1.202305310006 PE</updated-with-version>
                    <email>
                        <templates>
                            <template name="default">
                                <form-fields/>
                            </template>
                        </templates>
                        <parameters/>
                    </email>
                    <library-versions>
                        <orbeon>1</orbeon>
                    </library-versions>
                    <rendered-page-orientation>landscape</rendered-page-orientation>
                    <xbl>
                        <fr:number decimal-separator="," grouping-separator=" " digits-after-decimal="2"/>
                        <fr:time output-format="[H]:[m]:[s]"/>
                    </xbl>
                </metadata>
            </xf:instance>

            <!-- Attachments -->
            <xf:instance id="fr-form-attachments" xxf:exclude-result-prefixes="#all">
                <attachments/>
            </xf:instance>

            <!-- All form resources -->
            <xf:instance xxf:readonly="true" id="fr-form-resources" xxf:exclude-result-prefixes="#all">
                <resources>
                    <resource xml:lang="pl">
                        <subject-name>
                            <label>Nazwa przedmiotu</label>
                            <hint/>
                        </subject-name>
                        <exam>
                            <label>Egzamin</label>
                            <hint/>
                        </exam>
                        <student-term-number>
                            <label>Numer semestru studenta</label>
                            <hint/>
                        </student-term-number>
                        <ects-number>
                            <label>Liczba ECTS</label>
                            <hint/>
                        </ects-number>
                        <instructor>
                            <label>Prowadzący</label>
                            <hint/>
                        </instructor>
                        <grade>
                            <label>Ocena</label>
                            <hint/>
                        </grade>
                        <term>
                            <label>Semestr</label>
                            <hint/>



                        </term>



                        <term-number>
                            <label>Numer semestru</label>
                            <hint/>
                        </term-number>
                        <register-type>
                            <label>Typ rejestracji</label>
                            <hint/>
                        </register-type>
                        <student-group>
                            <label>Grupa studencka</label>
                            <hint/>
                        </student-group>
                        <starting-ects>
                            <label>Początkowe ECTS</label>
                            <hint/>
                        </starting-ects>
                        <final-ects>
                            <label>Końcowe ECTS</label>
                            <hint/>
                        </final-ects>
                        <nominal-ects>
                            <label>Nominalne ECTS</label>
                            <hint/>
                        </nominal-ects>
                        <obtained-ects>
                            <label>Zdobyte ECTS</label>
                            <hint/>
                        </obtained-ects>
                        <speciality>
                            <label>Specjalizacja</label>
                            <hint/>
                        </speciality>
                        <ects-difference>
                            <label>Różnica ECTS</label>
                            <hint/>
                        </ects-difference>
                        <personal-data-section>
                            <label>Dane osobowe</label>
                        </personal-data-section>
                        <overall-results-section>
                            <label>Podsumowanie przebiegu studiów</label>
                        </overall-results-section>
                        <term-results-section>
                            <label>Podsumowanie semestru</label>
                        </term-results-section>
                        <name>
                            <label>Imię</label>
                            <hint/>
                        </name>
                        <surname>
                            <label>Nazwisko</label>
                            <hint/>
                        </surname>
                        <birth-date>
                            <label>Data urodzenia</label>
                            <hint/>
                        </birth-date>

                        <student-id>
                            <label>Id studenta</label>
                            <hint/>
                        </student-id>
                    </resource>
                </resources>
            </xf:instance>
            <xf:instance xxf:readonly="true" xxf:exclude-result-prefixes="#all"
                         id="overall-results-repeat-template">
                <overall-results-repeat-iteration>
                    <term-number/>
                    <register-type/>
                    <student-group/>
                    <starting-ects/>
                    <final-ects/>
                    <nominal-ects/>
                    <obtained-ects/>
                    <speciality/>
                    <ects-difference/>
                </overall-results-repeat-iteration>
            </xf:instance>
            <xf:instance id="empty-term">
                <root>
                    <_>
                        <empty-item-label>Nie wybieram żadnego semestru</empty-item-label>
                        <empty-item-value>none</empty-item-value>
                    </_>
                </root>

            </xf:instance>
            <xf:instance xxf:readonly="true" xxf:exclude-result-prefixes="#all"
                         id="term-subjects-repeat-template">
                <term-subjects-repeat-iteration>
                    <subject-name/>
                    <exam/>
                    <student-term-number/>
                    <ects-number/>
                    <instructor/>
                    <grade/>
                </term-subjects-repeat-iteration>
            </xf:instance>
            <xf:instance id="getStudentData-instance" class="fr-service"
                         xxf:exclude-result-prefixes="#all">
                <body xmlns:xxbl="http://orbeon.org/oxf/xml/xbl"
                      xmlns:fbf="java:org.orbeon.oxf.fb.FormBuilderXPathApi">&lt;params&gt;
                &lt;param name="id"/&gt;
                &lt;/params&gt;</body>
            </xf:instance>
            <xf:submission id="getStudentData-submission" class="fr-service"
                           resource="http://localhost:8080/api/users/user"
                           method="get"
                           serialization="application/x-www-form-urlencoded"
                           mediatype="application/x-www-form-urlencoded"/>
            <xf:action id="getStudentData-binding">
                <xf:action event="xforms-value-changed" ev:observer="student-id-control" if="true()">
                    <xf:send submission="getStudentData-submission"/>
                </xf:action>
                <xf:action event="xforms-submit" ev:observer="getStudentData-submission">
                    <xf:var name="request-instance-name" value="'getStudentData-instance'"/>
                    <xf:action>
                        <xf:action class="fr-set-service-value-action">
                            <xf:var name="control-name" value="'student-id'"/>
                            <xf:var name="parameter-name" value="'id'"/>
                        </xf:action>
                    </xf:action>
                </xf:action>
                <xf:action event="xforms-submit-done" ev:observer="getStudentData-submission">
                    <xf:action class="fr-save-to-dataset-action">
                        <xf:var name="dataset-name">studentDataset</xf:var>
                    </xf:action>
                    <xf:action class="fr-itemset-action">
                        <xf:var name="control-name" value="'term'"/>
                        <xf:var name="response-items" value="(//terms/_ | instance('empty-term')//_)"/>
                        <xf:var name="item-label" value="termNumber | empty-item-label"/>
                        <xf:var name="item-value" value="termNumber | empty-item-value"/>
                    </xf:action>
                </xf:action>
            </xf:action>
            <xf:dispatch name="load-student-data" delay="10" targetid="fr-form-model"
                         event="xforms-submit-done"
                         ev:observer="getStudentData-submission"/>
            <xf:action event="load-student-data" if="true()">
                <xf:var name="insert-template"
                        select="xxf:extract-document(instance('overall-results-repeat-template'))">
                </xf:var>
                <xf:delete ref="instance('fr-form-instance')//overall-results-repeat-iteration"/>
                <xf:action iterate="fr:dataset('studentDataset')//overallResults/terms/_">
                    <xf:var name="current" select="."/>
                    <xf:setvalue ref="$insert-template//term-number" value="$current//termNumber"/>
                    <xf:setvalue ref="$insert-template//register-type" value="$current//registerType"/>
                    <xf:setvalue ref="$insert-template//student-group" value="$current//studentGroup"/>
                    <xf:setvalue ref="$insert-template//starting-ects" value="$current//startingECTS"/>
                    <xf:setvalue ref="$insert-template//final-ects" value="$current//finalECTS"/>
                    <xf:setvalue ref="$insert-template//nominal-ects" value="$current//nominalECTS"/>
                    <xf:setvalue ref="$insert-template//obtained-ects" value="$current//obtainedECTS"/>
                    <xf:setvalue ref="$insert-template//speciality" value="$current//speciality"/>


                    <xf:insert if="count(instance('fr-form-instance')//overall-results-section/overall-results-repeat/overall-results-repeat-iteration) &gt; 0"
                               ref="instance('fr-form-instance')//overall-results-section/overall-results-repeat/overall-results-repeat-iteration"
                               at="last()"
                               position="after"
                               origin="$insert-template">
                    </xf:insert>
                    <xf:insert if="count(instance('fr-form-instance')//overall-results-section/overall-results-repeat/overall-results-repeat-iteration) = 0"
                               context="instance('fr-form-instance')//overall-results-section/overall-results-repeat"
                               at="last()"
                               origin="$insert-template">

                    </xf:insert>
                </xf:action>
            </xf:action>
            <xf:dispatch name="term-changed-data" delay="10" targetid="fr-form-model"
                         event="xforms-value-changed"
                         ev:observer="term-control"/>
            <xf:action event="term-changed-data" if="true()">
                <xf:var name="insert-template"
                        select="xxf:extract-document(instance('term-subjects-repeat-template'))">
                </xf:var>
                <xf:var name="selected-term"
                        value="instance('fr-form-instance')//term"/>
                <xf:delete ref="instance('fr-form-instance')//term-subjects-repeat-iteration"/>
                <xf:action iterate="fr:dataset('studentDataset')//overallResults/terms/_[./termNumber = $selected-term]/subjects/_">
                    <xf:var name="current" select="."/>
                    <xf:setvalue ref="$insert-template//subject-name" value="$current//subjectName"/>
                    <xf:setvalue ref="$insert-template//exam" value="$current//exam"/>
                    <xf:setvalue ref="$insert-template//student-term-number" value="$current//studentTermNumber"/>
                    <xf:setvalue ref="$insert-template//ects-number" value="$current//ectsNumber"/>
                    <xf:setvalue ref="$insert-template//instructor" value="$current//instructor"/>
                    <xf:setvalue ref="$insert-template//grade" value="$current//grade"/>


                    <xf:insert if="count(instance('fr-form-instance')//term-subjects-repeat/term-subjects-repeat-iteration) &gt; 0"
                               ref="instance('fr-form-instance')//term-subjects-repeat/term-subjects-repeat-iteration"
                               at="last()"
                               position="after"
                               origin="$insert-template">
                    </xf:insert>
                    <xf:insert if="count(instance('fr-form-instance')//term-subjects-repeat/term-subjects-repeat-iteration) = 0"
                               context="instance('fr-form-instance')//term-subjects-repeat"
                               at="last()"
                               origin="$insert-template">

                    </xf:insert>
                </xf:action>
            </xf:action>
        </xf:model>
    </xh:head>
    <xh:body>
        <fr:view>
            <fr:body xmlns:xbl="http://www.w3.org/ns/xbl" xmlns:p="http://www.orbeon.com/oxf/pipeline"
                     xmlns:oxf="http://www.orbeon.com/oxf/processors">
                <fr:section id="personal-data-section-section" bind="personal-data-section-bind">
                    <xf:label ref="$form-resources/personal-data-section/label"/>
                    <fr:grid id="personal-data-grid-grid" bind="personal-data-grid-bind">
                        <fr:c y="1" x="1" w="6">
                            <xf:input id="name-control" bind="name-bind">
                                <xf:label ref="$form-resources/name/label"/>
                                <xf:hint ref="$form-resources/name/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c y="1" x="7" w="6">
                            <xf:input id="surname-control" bind="surname-bind">
                                <xf:label ref="$form-resources/surname/label"/>
                                <xf:hint ref="$form-resources/surname/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="2" w="6">
                            <fr:date xmlns:xxbl="http://orbeon.org/oxf/xml/xbl"
                                     xmlns:DateSupport="java:org.orbeon.xbl.DateSupportJava"
                                     id="birth-date-control"
                                     bind="birth-date-bind">
                                <xf:label ref="$form-resources/birth-date/label"/>
                                <xf:hint ref="$form-resources/birth-date/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </fr:date>

                        </fr:c>
                        <fr:c x="7" y="2" w="6">
                            <xf:input id="student-id-control" bind="student-id-bind">
                                <xf:label ref="$form-resources/student-id/label"/>
                                <xf:hint ref="$form-resources/student-id/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                    </fr:grid>
                </fr:section>
                <fr:section id="overall-results-section-section" bind="overall-results-section-bind">
                    <xf:label ref="$form-resources/overall-results-section/label"/>

                    <fr:grid id="overall-results-repeat-grid" bind="overall-results-repeat-bind"
                             repeat="content"
                             min="{'1000'}"
                             template="instance('overall-results-repeat-template')"
                             apply-defaults="true"
                             fb:initial-iterations="first"
                             max="{'0'}"
                             freeze="{'1000'}">
                        <fr:c x="1" y="1" w="4">
                            <xf:input id="term-number-control" bind="term-number-bind">
                                <xf:label ref="$form-resources/term-number/label"/>
                                <xf:hint ref="$form-resources/term-number/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="1" w="4" h="1">
                            <xf:input id="register-type-control" bind="register-type-bind">
                                <xf:label ref="$form-resources/register-type/label"/>
                                <xf:hint ref="$form-resources/register-type/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="1" w="4">
                            <xf:input id="student-group-control" bind="student-group-bind">
                                <xf:label ref="$form-resources/student-group/label"/>
                                <xf:hint ref="$form-resources/student-group/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="2" w="4">
                            <xf:input id="starting-ects-control" bind="starting-ects-bind">
                                <xf:label ref="$form-resources/starting-ects/label"/>
                                <xf:hint ref="$form-resources/starting-ects/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="2" w="4" h="1">
                            <xf:input id="final-ects-control" bind="final-ects-bind">
                                <xf:label ref="$form-resources/final-ects/label"/>
                                <xf:hint ref="$form-resources/final-ects/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="2" w="4">
                            <xf:input id="nominal-ects-control" bind="nominal-ects-bind">
                                <xf:label ref="$form-resources/nominal-ects/label"/>
                                <xf:hint ref="$form-resources/nominal-ects/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="3" w="4">
                            <xf:input id="obtained-ects-control" bind="obtained-ects-bind">
                                <xf:label ref="$form-resources/obtained-ects/label"/>
                                <xf:hint ref="$form-resources/obtained-ects/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="3" w="4">
                            <xf:input id="speciality-control" bind="speciality-bind">
                                <xf:label ref="$form-resources/speciality/label"/>
                                <xf:hint ref="$form-resources/speciality/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>
                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="3" w="4">
                            <xf:input id="ects-difference-control" bind="ects-difference-bind">
                                <xf:label ref="$form-resources/ects-difference/label"/>
                                <xf:hint ref="$form-resources/ects-difference/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>

                            </xf:input>
                        </fr:c>
                    </fr:grid>
                    <fr:grid id="overall-results-grid-grid" bind="overall-results-grid-bind">
                        <fr:c x="1" y="1" w="6"/>
                        <fr:c x="7" y="1" w="6"/>
                    </fr:grid>

                    <br/>
                    <xh:table border="1" width="100%">
                        <xh:tr class="table-header">
                            <xh:th>Numer semestru</xh:th>
                            <xh:th>Typ rejestracji</xh:th>
                            <xh:th>Grupa</xh:th>
                            <xh:th>Początkowe ECTS</xh:th>
                            <xh:th>Końcowe ECTS</xh:th>
                            <xh:th>Nominalne ECTS</xh:th>
                            <xh:th>Zdobyte ECTS</xh:th>
                            <xh:th>Specjalizacja</xh:th>
                            <xh:th>Różnica ECTS</xh:th>
                        </xh:tr>
                        <xf:repeat ref=".//overall-results-repeat-iteration">
                            <xh:tr>
                                <xh:td class="td-text-value">
                                    <xf:output value="./term-number"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./register-type"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./student-group"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./starting-ects"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./final-ects"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./nominal-ects"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./obtained-ects"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="speciality"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./ects-difference"/>
                                </xh:td>
                            </xh:tr>
                        </xf:repeat>
                    </xh:table>
                </fr:section>
                <fr:section id="term-results-section-section" bind="term-results-section-bind">
                    <xf:label ref="$form-resources/term-results-section/label"/>
                    <fr:grid id="term-results-grid-grid" bind="term-results-grid-bind">
                        <fr:c x="1" y="1" w="6">
                            <xf:select1 id="term-control" bind="term-bind" appearance="dropdown">
                                <xf:label ref="$form-resources/term/label"/>
                                <xf:hint ref="$form-resources/term/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                                <xf:itemset ref="$form-resources/term/item">
                                    <xf:label ref="label"/>
                                    <xf:value ref="value"/>
                                    <xf:hint ref="hint"/>
                                </xf:itemset>
                            </xf:select1>

                        </fr:c>
                        <fr:c x="7" y="1" w="6">

                        </fr:c>


                    </fr:grid>
                    <fr:grid id="term-subjects-repeat-grid" bind="term-subjects-repeat-bind"
                             repeat="content"
                             min="1"
                             template="instance('term-subjects-repeat-template')"
                             apply-defaults="true"
                             fb:initial-iterations="first">
                        <fr:c x="1" y="1" w="4">
                            <xf:input id="subject-name-control" bind="subject-name-bind">
                                <xf:label ref="$form-resources/subject-name/label"/>
                                <xf:hint ref="$form-resources/subject-name/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="1" w="4" h="1">
                            <xf:input id="exam-control" bind="exam-bind">
                                <xf:label ref="$form-resources/exam/label"/>
                                <xf:hint ref="$form-resources/exam/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="1" w="4">
                            <xf:input id="student-term-number-control" bind="student-term-number-bind">
                                <xf:label ref="$form-resources/student-term-number/label"/>
                                <xf:hint ref="$form-resources/student-term-number/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="1" y="2" w="4">
                            <xf:input id="ects-number-control" bind="ects-number-bind">
                                <xf:label ref="$form-resources/ects-number/label"/>
                                <xf:hint ref="$form-resources/ects-number/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="5" y="2" w="4">
                            <xf:input id="instructor-control" bind="instructor-bind">
                                <xf:label ref="$form-resources/instructor/label"/>
                                <xf:hint ref="$form-resources/instructor/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                        <fr:c x="9" y="2" w="4">
                            <xf:input id="grade-control" bind="grade-bind">
                                <xf:label ref="$form-resources/grade/label"/>
                                <xf:hint ref="$form-resources/grade/hint"/>
                                <xf:alert ref="$fr-resources/detail/labels/alert"/>


                            </xf:input>
                        </fr:c>
                    </fr:grid>
                    <br/>
                    <xh:table border="1" width="100%">
                        <xh:tr class="table-header">
                            <xh:th>Nazwa przedmiotu</xh:th>
                            <xh:th>Egzamin</xh:th>
                            <xh:th>Numer semestru studenta</xh:th>
                            <xh:th>Liczba ECTS</xh:th>
                            <xh:th>Prowadzący</xh:th>
                            <xh:th>Ocena</xh:th>
                        </xh:tr>
                        <xf:repeat ref=".//term-subjects-repeat-iteration">
                            <xh:tr>
                                <xh:td class="td-text-value">
                                    <xf:output value="./subject-name"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./exam"/>
                                </xh:td>
                                <xh:td class="td-text-value">
                                    <xf:output value="./student-term-number"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./ects-number"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./instructor"/>
                                </xh:td>
                                <xh:td class="td-number-value">
                                    <xf:output value="./grade"/>
                                </xh:td>
                            </xh:tr>
                        </xf:repeat>
                    </xh:table>
                </fr:section>
            </fr:body>
        </fr:view>
    </xh:body>
</xh:html>